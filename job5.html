<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ¨çº¿è´­ç‰©æŠ˜æ‰£ç³»ç»Ÿ - å­¦å·æœ«ä½8</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .header {
            grid-column: 1 / -1;
            text-align: center;
            padding: 20px;
            background: linear-gradient(to right, #4b6cb7, #182848);
            color: white;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
        }
        
        .section-title {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .clock-container {
            text-align: center;
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        #liveClock {
            font-size: 2.2rem;
            font-weight: bold;
            letter-spacing: 3px;
            color: #f1c40f;
            margin: 10px 0;
        }
        
        .discount-info {
            background: #e8f4fc;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 5px solid #3498db;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        input,
        select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        input:focus,
        select:focus {
            border-color: #3498db;
            outline: none;
        }
        
        button {
            background: linear-gradient(to right, #3498db, #2c3e50);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        
        button:hover {
            background: linear-gradient(to right, #2980b9, #1a252f);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .result {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border: 1px solid #e0e0e0;
            line-height: 1.6;
        }
        
        .result p {
            margin: 8px 0;
            padding: 8px;
            background: white;
            border-radius: 4px;
            border-left: 4px solid #3498db;
        }
        
        .history-section {
            grid-column: 1 / -1;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        th,
        td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: #2c3e50;
            color: white;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        .highlight {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .special-rule {
            background-color: #fff8e1;
            border-left: 5px solid #ffc107;
            padding: 15px;
            margin-top: 20px;
            border-radius: 6px;
        }
        
        .special-rule h4 {
            color: #ff9800;
            margin-bottom: 8px;
        }
        
        .footer {
            grid-column: 1 / -1;
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            color: #7f8c8d;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
        }
        
        @media (max-width: 900px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>åœ¨çº¿è´­ç‰©æŠ˜æ‰£ç³»ç»Ÿ</h1>
        </div>
        <script>
            // ========== ç¬¬ä¸€ä¸ªæ–¹é¢ï¼šdocument.write() æ˜¾ç¤ºæŠ˜æ‰£ä¿¡æ¯ =========
            document.write('<div class="section" style="grid-column:1/-1;margin-bottom:20px;">');
            document.write('<h3 class="section-title">è´­ç‰©æŠ˜æ‰£å…¬å‘Š</h3>');
            document.write('<p>1. ğŸ‰VIPå®¢æˆ·äº«å—<strong>9æŠ˜</strong>ä¼˜æƒ ï¼</p>');
            document.write('<p>2. âš¡åŠ æ€¥æœåŠ¡æ”¶å–<strong>10%</strong>çš„åŠ æ€¥è´¹ç”¨ã€‚</p>');
            document.write('<p>3. â°æ¯å°æ—¶å‰10åˆ†é’Ÿå†…ä¸‹å•äº«å—<strong>85æŠ˜</strong>æ—¶é—´æŠ˜æ‰£ï¼</p>');
            document.write('<p>4. ğŸ‰æ™®é€šå®¢æˆ·ä¸”é‡‘é¢>200å…ƒæ—¶é¢å¤–å‡10å…ƒã€‚</p>');
            document.write('</div>');
        </script>
        <div class="clock-container">
            <h3>å®æ—¶æ—¶é’Ÿä¸æŠ˜æ‰£æ—¶é—´</h3>
            <div id="liveClock">00:00:00</div>
            <div id="discountMessage" class="discount-info">æŠ˜æ‰£ä¿¡æ¯å°†åœ¨æ­¤æ˜¾ç¤º</div>
        </div>

        <div class="section">
            <h2 class="section-title">è®¢å•ä¿¡æ¯è¾“å…¥</h2>
            <form id="orderForm">
                <div class="form-group">
                    <label for="customerName">å®¢æˆ·åç§° *</label>
                    <input type="text" id="customerName" placeholder="è¯·è¾“å…¥æ‚¨çš„å§“å" required>
                </div>

                <div class="form-group">
                    <label for="price">å•†å“å•ä»· (å…ƒ) *</label>
                    <input type="number" id="price" placeholder="è¯·è¾“å…¥å¤§äº0çš„æ•°å­—" min="0.01" step="0.01" required>
                </div>

                <div class="form-group">
                    <label for="quantity">è´­ä¹°æ•°é‡ *</label>
                    <input type="number" id="quantity" placeholder="è¯·è¾“å…¥å¤§äº0çš„æ•´æ•°" min="1" step="1" required>
                </div>

                <div class="form-group">
                    <label for="isVip">å®¢æˆ·ç±»å‹</label>
                    <select id="isVip">
                        <option value="false">æ™®é€šå®¢æˆ·</option>
                        <option value="true">VIPå®¢æˆ·</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="isUrgent">åŠ æ€¥æœåŠ¡</label>
                    <select id="isUrgent">
                        <option value="false">æ™®é€šå‘è´§</option>
                        <option value="true">åŠ æ€¥å‘è´§ (+10%è´¹ç”¨)</option>
                    </select>
                </div>

                <button type="button" id="addOrderBtn">æ·»åŠ è®¢å•</button>
            </form>

            <div class="special-rule">
                <p>å½“å®¢æˆ·æ˜¯æ™®é€šå®¢æˆ·ï¼ˆéVIPï¼‰ä¸”é€šç”¨æŠ˜æ‰£åçš„é‡‘é¢ > 200å…ƒæ—¶ï¼Œå†é¢å¤–å‡10å…ƒï¼ˆè®¢å•é‡‘é¢æœ€ä½ä¸ä½äº0ï¼‰ã€‚</p>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title">è®¢å•è®¡ç®—ç»“æœ</h2>
            <div id="calculationResult" class="result">
                <p>è®¢å•ä¿¡æ¯å°†åœ¨æ­¤æ˜¾ç¤º...</p>
            </div>
        </div>

        <div class="section history-section">
            <h2 class="section-title">å–å®¶é¢æ¿ - æˆäº¤å†å²</h2>
            <button type="button" id="clearHistoryBtn">æ¸…ç©ºå†å²è®°å½•</button>
            <div id="historyDashboard">
                <table>
                    <thead>
                        <tr>
                            <th>åºå·</th>
                            <th>å®¢æˆ·åç§°</th>
                            <th>å•ä»·</th>
                            <th>æ•°é‡</th>
                            <th>å®¢æˆ·ç±»å‹</th>
                            <th>åŠ æ€¥</th>
                            <th>æœ€ç»ˆé‡‘é¢</th>
                            <th>æ—¶é—´</th>
                        </tr>
                    </thead>
                    <tbody id="historyTableBody">
                        <!-- å†å²è®°å½•å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="footer">
            <p>åœ¨çº¿è´­ç‰©æŠ˜æ‰£ç³»ç»Ÿ &copy; 2025 </p>
        </div>
    </div>

    <script>
        // ========== ç¬¬äºŒä¸ªæ–¹é¢ï¼šæ¨¡æ‹Ÿæ—¶é’Ÿå’Œæ—¶é—´æŠ˜æ‰£åˆ¤æ–­ ==========
        function updateClock() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');
            const weekdays = ["æ˜ŸæœŸæ—¥", "æ˜ŸæœŸä¸€", "æ˜ŸæœŸäºŒ", "æ˜ŸæœŸä¸‰", "æ˜ŸæœŸå››", "æ˜ŸæœŸäº”", "æ˜ŸæœŸå…­"];
            const weekday = weekdays[now.getDay()];
            const dateStr = `${now.getFullYear()}å¹´${now.getMonth()+1}æœˆ${now.getDate()}æ—¥`;

            document.getElementById('liveClock').innerHTML =
                `${dateStr} ${weekday} ${hours}:${minutes}:${seconds}`;

            // åˆ¤æ–­æ˜¯å¦åœ¨æ¯å°æ—¶çš„å‰10åˆ†é’Ÿå†…ï¼ˆ0-9åˆ†é’Ÿï¼‰
            const currentMinute = now.getMinutes();
            const discountMessage = document.getElementById('discountMessage');

            if (currentMinute < 10) {
                discountMessage.innerHTML =
                    `<strong>æ—¶é—´æŠ˜æ‰£ç”Ÿæ•ˆä¸­ï¼</strong> å½“å‰æ—¶é—´åœ¨æ¯å°æ—¶çš„å‰10åˆ†é’Ÿå†…ï¼Œäº«å—<strong>85æŠ˜</strong>ä¼˜æƒ ï¼`;
                discountMessage.style.backgroundColor = '#d4edda';
                discountMessage.style.borderLeftColor = '#28a745';
            } else {
                discountMessage.innerHTML =
                    `<strong>æ—¶é—´æŠ˜æ‰£æœªç”Ÿæ•ˆ</strong> å½“å‰æ—¶é—´ä¸åœ¨æ¯å°æ—¶çš„å‰10åˆ†é’Ÿå†…ï¼Œæ— æ—¶é—´æŠ˜æ‰£ã€‚`;
                discountMessage.style.backgroundColor = '#f8d7da';
                discountMessage.style.borderLeftColor = '#dc3545';
            }
        }

        // åˆå§‹æ›´æ–°æ—¶é’Ÿï¼Œç„¶åæ¯ç§’æ›´æ–°ä¸€æ¬¡
        updateClock();
        setInterval(updateClock, 1000);

        // ========== ç¬¬ä¸‰ä¸ªæ–¹é¢ï¼šè¡¨å•éªŒè¯ ==========
        function validateForm() {
            const customerName = document.getElementById('customerName').value.trim();
            const price = parseFloat(document.getElementById('price').value);
            const quantity = parseInt(document.getElementById('quantity').value);

            // éªŒè¯å®¢æˆ·åç§°ä¸èƒ½ä¸ºç©º
            if (customerName === '') {
                alert('é”™è¯¯ï¼šå®¢æˆ·åç§°ä¸èƒ½ä¸ºç©ºï¼');
                return false;
            }

            // éªŒè¯å•†å“å•ä»·å¿…é¡»æ˜¯å¤§äº0çš„æ•°å­—
            if (isNaN(price) || price <= 0) {
                alert('é”™è¯¯ï¼šå•†å“å•ä»·å¿…é¡»æ˜¯å¤§äº0çš„æ•°å­—ï¼');
                return false;
            }

            // éªŒè¯æ•°é‡å¿…é¡»æ˜¯å¤§äº0çš„æ•´æ•°
            if (isNaN(quantity) || quantity <= 0 || !Number.isInteger(quantity)) {
                alert('é”™è¯¯ï¼šæ•°é‡å¿…é¡»æ˜¯å¤§äº0çš„æ•´æ•°ï¼');
                return false;
            }

            return true;
        }

        // ========== ç¬¬å››ä¸ªæ–¹é¢ï¼šè®¢å•è®¡ç®—ä¸æ˜¾ç¤º ==========
        let orderHistory = [];

        function calculateOrder() {
            if (!validateForm()) {
                return;
            }

            // è·å–è¡¨å•æ•°æ®
            const customerName = document.getElementById('customerName').value.trim();
            const price = parseFloat(document.getElementById('price').value);
            const quantity = parseInt(document.getElementById('quantity').value);
            const isVip = document.getElementById('isVip').value === 'true';
            const isUrgent = document.getElementById('isUrgent').value === 'true';

            // è·å–å½“å‰æ—¶é—´çš„åˆ†é’Ÿæ•°
            const now = new Date();
            const minute = now.getMinutes();

            // â‘  è®¡ç®—æ­£å¸¸æ€»ä»·
            const baseTotal = price * quantity;

            // â‘¡ VIPæŠ˜æ‰£
            let afterVip = baseTotal;
            if (isVip) {
                afterVip = baseTotal * 0.9; // VIPä¹æŠ˜
            }

            // â‘¢ åŠ æ€¥è´¹ç”¨
            let afterUrgent = afterVip;
            if (isUrgent) {
                afterUrgent = afterVip * 1.1; // åŠ æ€¥åŠ æ”¶10%
            }

            // â‘£ æ—¶é—´æŠ˜æ‰£ï¼ˆå‰10åˆ†é’Ÿ85æŠ˜ï¼‰
            let finalTotal = afterUrgent;
            const hitTimeDiscount = (minute < 10);

            if (hitTimeDiscount) {
                finalTotal = afterUrgent * 0.85; // å‰10åˆ†é’Ÿ85æŠ˜
            }

            // ====== å­¦å·æœ«ä½8 ======
            // å½“ã€Œå®¢æˆ·æ˜¯æ™®é€šå®¢æˆ·ï¼ˆé VIPï¼‰ä¸” é€šç”¨æŠ˜æ‰£åçš„é‡‘é¢ > 200 å…ƒã€æ—¶ï¼š
            // å†é¢å¤–å‡10å…ƒï¼ˆè®¢å•é‡‘é¢æœ€ä½ä¸ä½äº0ï¼‰
            if (!isVip && finalTotal > 200) {
                finalTotal = Math.max(finalTotal - 10, 0); // å‡10å…ƒï¼Œæœ€ä½ä¸º0
            }

            // â‘¤ æ„å»ºæ˜¾ç¤ºå­—ç¬¦ä¸²
            let tipsHtml = '';
            tipsHtml += `<p><strong>å®¢æˆ·åç§°ï¼š</strong>${customerName}</p>`;
            tipsHtml += `<p><strong>å•†å“å•ä»·ï¼š</strong>${price.toFixed(2)} å…ƒ</p>`;
            tipsHtml += `<p><strong>è´­ä¹°æ•°é‡ï¼š</strong>${quantity} ä»¶</p>`;
            tipsHtml += `<p><strong>å®¢æˆ·ç±»å‹ï¼š</strong>${isVip ? 'VIPå®¢æˆ·' : 'æ™®é€šå®¢æˆ·'}</p>`;
            tipsHtml += `<p><strong>å‘è´§æ–¹å¼ï¼š</strong>${isUrgent ? 'åŠ æ€¥å‘è´§' : 'æ™®é€šå‘è´§'}</p>`;
            tipsHtml += `<p><strong>ä¸‹å•æ—¶é—´åˆ†é’Ÿæ•°ï¼š</strong>${minute} åˆ†é’Ÿ</p>`;
            tipsHtml += `<p><strong>åŸºç¡€æ€»ä»·ï¼š</strong><span class="highlight">${baseTotal.toFixed(2)} å…ƒ</span></p>`;

            if (isVip) {
                tipsHtml += `<p><strong>VIP 9æŠ˜åï¼š</strong>${afterVip.toFixed(2)} å…ƒ</p>`;
            }

            if (isUrgent) {
                tipsHtml += `<p><strong>åŠ æ€¥æœåŠ¡è´¹åï¼š</strong>${afterUrgent.toFixed(2)} å…ƒ</p>`;
            }

            if (hitTimeDiscount) {
                tipsHtml += `<p><strong>æ—¶é—´æŠ˜æ‰£(85æŠ˜)åï¼š</strong>${finalTotal.toFixed(2)} å…ƒ</p>`;
            }

            // æ˜¾ç¤ºç‰¹æ®Šè§„åˆ™åº”ç”¨æƒ…å†µ
            if (!isVip && finalTotal > 200) {
                tipsHtml += `<p><strong>å­¦å·8ç‰¹æ®Šè§„åˆ™(å‡10å…ƒ)åï¼š</strong><span class="highlight">${finalTotal.toFixed(2)} å…ƒ</span></p>`;
            } else {
                tipsHtml += `<p><strong>æœ€ç»ˆé‡‘é¢ï¼š</strong><span class="highlight">${finalTotal.toFixed(2)} å…ƒ</span></p>`;
            }

            // æ˜¾ç¤ºè®¡ç®—ç»“æœ
            document.getElementById('calculationResult').innerHTML = tipsHtml;

            // å°†è®¢å•æ·»åŠ åˆ°å†å²è®°å½•
            const orderRecord = {
                id: orderHistory.length + 1,
                customerName,
                price,
                quantity,
                isVip,
                isUrgent,
                finalTotal,
                timestamp: now.toLocaleString()
            };

            orderHistory.push(orderRecord);

            // æ›´æ–°å–å®¶é¢æ¿
            renderDashboard();

            // æ¸…ç©ºè¡¨å•
            document.getElementById('orderForm').reset();
        }

        // ========== ç¬¬äº”ä¸ªæ–¹é¢ï¼šå–å®¶é¢æ¿ - æ˜¾ç¤ºæˆäº¤å†å² ==========
        function renderDashboard() {
            const tableBody = document.getElementById('historyTableBody');
            tableBody.innerHTML = '';

            // è®¡ç®—ç»Ÿè®¡ä¿¡æ¯
            let totalOrders = orderHistory.length;
            let totalRevenue = 0;
            let vipOrders = 0;

            orderHistory.forEach(order => {
                totalRevenue += order.finalTotal;
                if (order.isVip) vipOrders++;

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${order.id}</td>
                    <td>${order.customerName}</td>
                    <td>${order.price.toFixed(2)}</td>
                    <td>${order.quantity}</td>
                    <td>${order.isVip ? 'VIP' : 'æ™®é€š'}</td>
                    <td>${order.isUrgent ? 'æ˜¯' : 'å¦'}</td>
                    <td class="highlight">${order.finalTotal.toFixed(2)}</td>
                    <td>${order.timestamp}</td>
                `;
                tableBody.appendChild(row);
            });

            // å¦‚æœæ²¡æœ‰å†å²è®°å½•ï¼Œæ˜¾ç¤ºæç¤ºä¿¡æ¯
            if (orderHistory.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="8" style="text-align:center;">æš‚æ— è®¢å•è®°å½•</td>`;
                tableBody.appendChild(row);
            }

            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤º
            const statsHtml = `
                <p><strong>æ€»è®¢å•æ•°ï¼š</strong>${totalOrders} å•</p>
                <p><strong>æ€»æˆäº¤é¢ï¼š</strong>${totalRevenue.toFixed(2)} å…ƒ</p>
                <p><strong>VIPè®¢å•æ•°ï¼š</strong>${vipOrders} å•</p>
                <p><strong>å¹³å‡æ¯å•é‡‘é¢ï¼š</strong>${totalOrders > 0 ? (totalRevenue/totalOrders).toFixed(2) : '0.00'} å…ƒ</p>
            `;

            // å¦‚æœå·²ç»æœ‰å–å®¶é¢æ¿ç»Ÿè®¡ä¿¡æ¯åŒºåŸŸï¼Œåˆ™æ›´æ–°ï¼Œå¦åˆ™åˆ›å»º
            let statsDiv = document.getElementById('dashboardStats');
            if (!statsDiv) {
                statsDiv = document.createElement('div');
                statsDiv.id = 'dashboardStats';
                statsDiv.className = 'result';
                document.querySelector('.history-section').insertBefore(statsDiv, document.getElementById('historyDashboard'));
            }
            statsDiv.innerHTML = `<h3>æˆäº¤ç»Ÿè®¡</h3>${statsHtml}`;
        }

        // ========== é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ– ==========
        document.addEventListener('DOMContentLoaded', function() {
            // ç»‘å®šæ·»åŠ è®¢å•æŒ‰é’®äº‹ä»¶
            document.getElementById('addOrderBtn').addEventListener('click', calculateOrder);

            // ç»‘å®šæ¸…ç©ºå†å²è®°å½•æŒ‰é’®äº‹ä»¶
            document.getElementById('clearHistoryBtn').addEventListener('click', function() {
                if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•å—ï¼Ÿ')) {
                    orderHistory = [];
                    renderDashboard();
                }
            });

            // åˆå§‹æ¸²æŸ“å–å®¶é¢æ¿
            renderDashboard();

            // æ·»åŠ è¡¨å•å›è½¦æäº¤åŠŸèƒ½
            const formInputs = document.querySelectorAll('#orderForm input');
            formInputs.forEach(input => {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        calculateOrder();
                    }
                });
            });
        });
    </script>
</body>

</html>